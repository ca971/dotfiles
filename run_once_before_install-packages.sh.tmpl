#!/bin/bash

# --- 1. DÃ©tection de l'OS ---
OS_TYPE="{{ .chezmoi.os }}"
echo "ðŸ” OS dÃ©tectÃ© : $OS_TYPE"

# --- 2. Installation pour macOS ---
{{ if eq .chezmoi.os "darwin" -}}
if ! command -v brew &> /dev/null; then
    echo "ðŸº Installation de Homebrew..."
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
    # Configurer brew dans le shell actuel pour la suite du script
    eval "$(/opt/homebrew/bin/brew shellenv)" 2>/dev/null || eval "$(/usr/local/bin/brew shellenv)"
fi

echo "ðŸ“¦ Installation des outils Power User (macOS)..."
brew install eza lsd bat fd ripgrep fzf htop btop duf gping dog p7zip neovim tldr jq
{{ end -}}

# --- 3. Installation pour Linux (Debian/Ubuntu/WSL) ---
{{ if eq .chezmoi.os "linux" -}}
echo "ðŸ“¦ Mise Ã  jour et installation des outils Power User (Linux)..."
sudo apt update && sudo apt install -y \
    eza lsd bat fd-find ripgrep fzf htop btop duf p7zip-full nvim jq curl

# Correction pour 'bat' qui s'appelle souvent 'batcat' sur Ubuntu
mkdir -p ~/.local/bin
ln -sf /usr/bin/batcat ~/.local/bin/bat
{{ end -}}

echo "âœ… DÃ©pendances installÃ©es avec succÃ¨s."

